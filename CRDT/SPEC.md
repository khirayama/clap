## 仕様

- 用語
  - 項目
  - インライン
  - テキスト
  - 編集者: ドキュメントの編集者で、デバイスの操作者
  - 共同編集者: 編集者と共に、同じドキュメントを編集する、別デバイスの操作者
  - 選択範囲: 始点と終点を持つ

- 選択範囲
  - a. 閉じている状態。単一項目のみを持ち、始点と終点が等しい。
  - b. インラインを選択している状態。単一項目のみを持ち、始点と終点が違う。
  - c. 単一項目を選択している状態。単一項目のみを持ち、始点と終点を持たない。
  - d. 複数項目を選択している状態。複数項目を持ち、始点と終点を持たない。

- 選択範囲、編集者、共同編集者の状態へ言及する
- ステータスとしてのxは実装完了、-は仕様定義完了

## Actions

- [-] 文字を入力(貼り付け)する変更
  - [x] a
    - 編集者選択範囲始点に任意の文字もしくは文字列を挿入する
    - 編集者選択範囲始点と終点を文字数分後ろへ移動させる
    - 共同編集者がaまたはbの場合
      - 共同編集者の選択範囲始点
        - 編集者と同一インライン上にあり編集者選択範囲始点より後ろにある場合、文字数分後ろへ移動させる
      - 共同編集者の選択範囲終点
        - 編集者と同一インライン上にあり編集者選択範囲始点より後ろにある場合、文字数分後ろへ移動させる
  - [x] b
    - 「文字を削除する - b」を適用
    - 「文字を入力(貼り付け)する - a」を適用
  - [-] c
    - 「文字を削除する - c」を適用
    - 新規段落項目を追加する
    - 新規インラインテキストを新規段落項目に追加する
    - 「文字を入力(貼り付け)する - a」を適用
  - [-] d
    - 「文字を削除する - d」を適用
    - 新規段落項目を追加する
    - 新規インラインテキストを新規段落項目に追加する
    - 「文字を入力(貼り付け)する - c」を適用

- [-] 文字を削除する変更
  - [x] a
    - 編集者選択範囲始点の前の文字を1文字削除
    - 編集者選択範囲始点と終点を1文字分前へ移動させる
    - 共同編集者がaまたはbの場合
      - 共同編集者の選択範囲始点
        - 編集者と同一インライン上にあり編集者選択範囲始点より後ろにある場合、1文字分前へ移動させる
      - 共同編集者の選択範囲終点
        - 編集者と同一インライン上にあり編集者選択範囲始点より後ろにある場合、1文字分前へ移動させる
  - [x] b
    - 編集者選択範囲の文字およびインラインを削除
    - 編集者選択範囲終点を始点へ移動させる
    - 共同編集者がaまたはbの場合
      - 共同編集者の選択範囲始点
        - 編集者と同一インライン上にあり編集者選択範囲始点より後ろにある場合、文字数分前(最小値は編集者選択範囲始点)へ移動させる
      - 共同編集者の選択範囲終点
        - 編集者と同一インライン上にあり編集者選択範囲終点より後ろにある場合、文字数分前(最小値は編集者選択範囲始点)へ移動させる
  - [x] c
    - 編集者選択範囲の項目を削除する
    - 次項目がある場合
      - 編集者選択範囲を次項目に移動する
    - 次項目がない場合
      - 編集者選択範囲を前項目に移動する
    - 次項目も前項目もない場合
      - 編集者選択範囲を親項目へ移動する
    - 次項目も前項目も親項目もない場合
      - 編集者選択範囲を外す
  - [-] d
    - 「文字を削除する操作 - c」を適用する

- [ ] 項目を追加する

- [ ] 項目を削除する

- [ ] インデントする

- [ ] アウトデントする

- [ ] 文字を装飾する

- [ ] 文字を非装飾する

## Usecases

- [-] 削除する操作
  - [-] a
    - 編集者選択範囲始点が項目のインライン先頭の先頭だった場合
      - 段落項目の場合
        - 「アウトデントする」を適用
      - 段落項目以外の場合
        - 段落項目へ変換する
    - 編集者選択範囲始点が先頭でない場合
      - 「文字を削除する操作 - a」を適用
    - インラインのテキストが空になった場合
      - 親項目のインラインが空になる場合、そのまま保持する
      - 親項目のインラインが空にならない場合
        - 前インラインがある場合
          - インラインを削除し前インライン末尾に該当選択範囲を移動する
        - 前インラインがない場合
          - インラインを削除し後インライン先頭に該当選択範囲を移動する
  - [-] b
    - 「文字を削除する操作 - b」を適用
    - インラインのテキストが空になった場合
      - 「文字を削除する操作 - a - インラインのテキストが空になった場合」を適用
  - [-] c
    - 「文字を削除する操作 - c」を適用
  - [-] d
    - 「削除する操作 - c」を適用する
